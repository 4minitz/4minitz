<template name="topicElement">
    <div class="well" data-id="{{topic._id}}" style="position: relative;">

        <!--Topic expand / collapse icon - positioned absolute, but relative to parent DIV -->
        {{#if topic.infoItems.length}}
            <span id="btnTopicExpandCollapse" style="position: absolute; top:0; left: 0; color: grey; cursor:pointer; font-size: 150%;" class="expand-collapse-triangle hidden-print">
                {{#if isCollapsed}}
                    <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
                {{else}}
                    <span class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>
                {{/if}}
            </span>
        {{/if}}
        <div>
            <div class="checkbox">
                <label for="btnToggleState_{{topic._id}}" class="labelTopicCb">
                    <input type="checkbox" class="checkbox btnToggleState" id="btnToggleState_{{topic._id}}" {{checkedState}} {{disabledState}}>
                </label>

                <h3 id="{{classForEdit}}" style="display: inline; cursor: {{cursorForEdit}};">
                    {{topic.subject}}
                    {{responsiblesHelper}}
                </h3>

                <!-- New-Topic-Label -->
                {{#if topic.isNew}}
                    <span class="badge" style="margin-bottom: 5px;">New</span>
                {{/if}}

                <!-- Manipulation Menu Icons -->
                <span class="pull-right pull-right-icons hidden-print">
                    {{#if isEditable}}
                        <a href="#" class="panel-dropper dropdown-toggle" data-toggle="dropdown">
                            <span class="glyphicon glyphicon-option-vertical"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="#" id="addTopicInfoItem_{{topic._id}}" class="addTopicInfoItem panel-link panel-menu"
                                   data-toggle="modal" data-target="#dlgAddInfoItem" title="Add info item to topic">
                                    <span class="glyphicon glyphicon-plus"></span>
                                    Add Info Item
                                </a>
                            </li>
                            <li>
                                <a href="#" id="addTopicInfoItem_{{topic._id}}" class="addTopicInfoItem panel-link panel-menu"
                                   data-toggle="modal" data-target="#dlgAddInfoItem" title="Add action item to topic">
                                    <span class="glyphicon glyphicon-plus"></span>
                                    Add Action Item
                                </a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a id="btnEditTopic" href="#" class="panel-link panel-menu" title="Edit topic">
                                    <span class="glyphicon glyphicon-pencil"></span>
                                    Edit Topic
                                </a>
                            </li>
                            <li>
                                <a href="#" class="js-toggle-recurring panel-link panel-menu" title="{{#if topic.isRecurring}}Set as not-recurring topic{{else}}Set as recurring topic{{/if}}">
                                    <span class="glyphicon glyphicon-repeat {{#if topic.isRecurring}}active-icon{{else}}grey-icon{{/if}}"></span>
                                    Set Recurring
                                </a>
                            </li>
                            <li>
                                <a id="btnDelTopic" href="#" class="panel-link panel-menu" title="Delete topic">
                                    <span class="glyphicon glyphicon-trash"></span>
                                    Delete Topic
                                </a>
                            </li>
                        </ul>
                    {{/if}}


                    {{#if topic.isRecurring}}
                        <a href="#" class="js-toggle-recurring panel-link" title="Set as not-recurring topic">
                            <span class="glyphicon glyphicon-repeat {{#if topic.isRecurring}}active-icon{{else}}grey-icon{{/if}}"></span>
                        </a>
                    {{/if}}
                    {{#if isEditable}}
                        <span class="topicDragDropHandle dragDropHandle glyphicon glyphicon-sort"></span>
                    {{/if}}
                </span>
                <br clear="all">
            </div>
        </div>

        {{#unless isCollapsed}}
            <div style="margin-left: 20px; padding-left: 5px;">
                <div class="panel-group itemPanel" id="disabled-accordion" role="tablist" aria-multiselectable="true">
                    {{#each topic.infoItems}}
                        {{> topicInfoItem getInfoItem @index}}
                    {{/each}}
                </div>
            </div>
        {{/unless}}
    </div>
</template>